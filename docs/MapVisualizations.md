# 하이브리드 맵 아키텍처 문서 (Hybrid Map Architecture)

이 문서는 **Terra In-cognita**에 구현된 4가지 서로 다른 맵 시각화 기술에 대해 설명합니다. 각 맵은 사용자 인터페이스에서 특정 목적을 수행하며 서로 다른 렌더링 라이브러리를 활용합니다.

---

## 1. 네비게이션 패널 (Navigation Panel) - 커맨드 코어
**구현체**: `WorldMap.jsx`, `InnerMap.jsx`
*   **기술 스택**: 순수 React 컴포넌트, CSS Grid/Flexbox, Custom State Logic
*   **렌더링 방식**:
    *   **궤도 뷰 (Orbit)**: CSS Grid를 활용한 인터랙티브 그리드 뷰.
    *   **지표면 뷰 (Surface)**: `div` 요소를 타일처럼 배치하여 지형 속성에 따라 스타일링.
*   **용도**: 게임플레이의 핵심 인터페이스. 유닛 이동, 건물 건설, 타일 직접 상호작용.

### 장점 및 단점
*   **장점 (Pros)**:
    *   **상호작용 용이성**: DOM 요소이므로 클릭, 호버, 접근성 등 React의 이벤트 핸들링을 그대로 사용할 수 있어 개발 속도가 빠릅니다.
    *   **스타일링 유연성**: CSS만으로 애니메이션과 테마 적용이 매우 쉽습니다.
*   **단점 (Cons)**:
    *   **성능 한계**: DOM 요소가 많아지면(예: 100x100 이상) 브라우저 렌더링 부하가 커져 프레임이 떨어집니다. 대규모 맵에는 부적합합니다.

### 오픈월드 확장성 및 방법
*   **확장 가능성**: 낮음 (DOM 기반 한계) ==> 내부맵으로만 사용할 기술, 월드맵이나 오픈월드에 1차적으로 사용불가.
*   **방법**:
    *   **가상화 (Virtualization)**: 화면에 보이는 타일만 렌더링하고 스크롤 시 교체하는 기법 도입 (React Window 등).
    *   **Canvas 마이그레이션**: 맵이 방대해지면 HTML5 Canvas 기반(Pixi.js, Phaser)으로 전환하여 GPU 가속을 활용해야 합니다.

---

## 2. 글로벌 맵 (Global Map) - 전략적 투영
**구현체**: `GlobalMap.jsx`
*   **기술 스택**: **D3.js** (Data-Driven Documents) + **TopoJSON**
*   **데이터 소스**: `world-atlas` (110m 해상도 국가 경계 데이터)
*   **렌더링 방식**:
    *   **SVG (Scalable Vector Graphics)**: D3의 `geoMercator` 투영법을 사용하여 벡터 패스로 계산 및 렌더링.
*   **용도**: 거시적인 정치/전략 지도. 지역 경계나 인구 통계 등을 시각화할 때 적합.

### 장점 및 단점
*   **장점 (Pros)**:
    *   **데이터 시각화**: 인구 밀도, 자원 분포 등 데이터를 색상이나 차트로 지도 위에 오버레이하기에 최적화되어 있습니다.
    *   **해상도 무관**: 벡터 그래픽이므로 아무리 확대해도 깨지지 않고 선명합니다.
*   **단점 (Cons)**:
    *   **복잡도 성능 저하**: 수천 개의 경로(Path)나 매우 상세한 지형 데이터를 렌더링할 때 SVG는 느려질 수 있습니다.
    *   **사실성 부족**: 위성 사진 같은 연속적인 텍스처 표현에는 적합하지 않습니다.

### 오픈월드 확장성 및 방법
*   **확장 가능성**: 중간 (데이터 시각화 전용)
*   **방법**:
    *   **Canvas 렌더링**: D3는 SVG뿐만 아니라 Canvas 컨텍스트로도 그릴 수 있습니다. 엔티티가 많아지면 렌더러만 Canvas로 교체하여 성능을 확보할 수 있습니다.
    *   **단순화 (Simplification)**: 줌 레벨에 따라 지형 데이터의 디테일(TopoJSON Quantization)을 조절하여 성능을 최적화합니다.

---

## 3. 지형 맵 (Terrain Map) - 위성 피드
**구현체**: `TerrainMap.jsx`
*   **기술 스택**: **Leaflet** (Raster Tile Engine)
*   **데이터 소스**: **OpenStreetMap** & **CartoDB Dark Matter** tiles
*   **렌더링 방식**:
    *   **타일링 (Tiling)**: 미리 렌더링된 사각형 이미지 타일을 좌표에 맞춰 이어 붙이는 방식.
*   **용도**: 현실적이고 익숙한 "지도(Google Maps 스타일)" 탐색 경험 제공.

### 장점 및 단점
*   **장점 (Pros)**:
    *   **대규모 맵 처리**: 이미지가 분할 로딩되므로 전 지구급의 거대한 맵도 끊김 없이 탐색 가능합니다.
    *   **표준화**: 지도 관련 라이브러리 생태계(마커, 히트맵 등)가 매우 풍부합니다.
*   **단점 (Cons)**:
    *   **동적 생성 어려움**: 이미지가 미리 만들어져 있어야 하므로, 플레이어가 지형을 실시간으로 바꾸거나 생성하는 게임에는 적용하기 어렵습니다. 커스텀 타일 서버 구축 비용이 큽니다.

### 오픈월드 확장성 및 방법
*   **확장 가능성**: 높음 (단, 정적 지형에 한함)
*   **방법**:
    *   **커스텀 타일 서버**: GeoServer 등을 이용해 게임 내 절차적 생성 지형을 타일 이미지로 실시간 변환하여 서빙할 수 있습니다.
    *   **Vector Tiles**: WebGL 기반 벡터 타일(Mapbox GL JS)을 도입하면 클라이언트에서 스타일을 동적으로 변경할 수 있어 확장성이 커집니다.

---

## 4. 월드 맵 (World Map) - 홀로그래픽 지구본
**구현체**: `WorldMapPanel.jsx` -> `public/world_globe.html`
*   **기술 스택**: **Three.js** (WebGL 3D Engine)
*   **렌더링 방식**:
    *   **WebGL CANVAS**: GPU를 사용하여 3D Icosahedron(이십면체) 와이어프레임 및 쉐이더 효과 렌더링.
    *   **포스트 프로세싱**: Bloom(네온 발광) 효과 적용.
*   **용도**: 몰입감 있는 3D 시각화, 플레이어의 미션 지역 표시, 화려한 연출용.

### 장점 및 단점
*   **장점 (Pros)**:
    *   **완전한 자유도**: 카메라, 조명, 쉐이더 등을 완벽하게 제어할 수 있어 가장 화려하고 독창적인 비주얼을 구현할 수 있습니다.
    *   **고성능**: 대량의 파티클이나 복잡한 3D 모델도 GPU 가속으로 부드럽게 처리합니다.
*   **단점 (Cons)**:
    *   **높은 구현 난이도**: 3D 수학과 GLSL 쉐이더 등에 대한 지식이 필요하며, 상호작용 구현(Raycasting 등)이 복잡합니다.

### 오픈월드 확장성 및 방법
*   **확장 가능성**: 매우 높음 (차세대 오픈월드 구현 가능)
*   **방법**:
    *   **LOD (Level of Detail)**: 카메라 거리에 따라 지형의 폴리곤 수를 조절하거나 QuadTree 기반 구체(Sphere) 알고리즘을 사용하면, 우주에서 지표면까지 끊김 없이 이어지는 **심리스(Seamless) 행성 착륙**을 구현할 수 있습니다. (예: No Man's Sky 방식)
    *   **절차적 생성**: 쉐이더를 이용해 런타임에 지형 높이와 텍스처를 생성하면 무한한 우주 맵 확장이 가능합니다.

---

## 요약 (Architectural Summary)

| 맵 종류 | 주요 구현 기술 | 렌더링 방식 | 오픈월드 적합성 | 확장 포인트 |
| :--- | :--- | :--- | :--- | :--- |
| **Navigation** | **React / DOM** | HTML/CSS | 낮음 (UI 중심) | 가상화(Virtualization) 또는 Canvas 전환 |
| **Global Map** | **D3.js** | SVG | 중간 (데이터 중심) | Canvas 렌더링 전환, 데이터 단순화 |
| **Terrain Map** | **Leaflet** | Raster Images | 높음 (정적 맵) | 벡터 타일 도입, 커스텀 타일 서버 |
| **World Map** | **Three.js** | WebGL | **최상 (3D/심리스)** | LOD, QuadTree Sphere, 절차적 쉐이더 |
